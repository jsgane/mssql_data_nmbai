[32m2026-02-26 12:12:27 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - 2526138 - LOGS_CAPTURED - Started capturing logs in process (pid: 2526138).
[32m2026-02-26 12:12:27 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - 2526138 - v_Inventory_Parts_Ops - STEP_START - Started execution of step "v_Inventory_Parts_Ops".
[32m2026-02-26 12:12:27 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - 
================================================================================
[32m2026-02-26 12:12:27 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - üöÄ PIPELINE MSSQL ‚Üí SNOWFLAKE
[32m2026-02-26 12:12:27 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - üì§‚û°Ô∏è‚ùÑÔ∏è  M√©thode: BCP + COPY INTO
[32m2026-02-26 12:12:27 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - ================================================================================

[32m2026-02-26 12:12:27 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - ================================================================================
[32m2026-02-26 12:12:27 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - üì§ Export BCP depuis SQL Server pour la table V_Inventory_Parts_Ops
[32m2026-02-26 12:12:27 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - ================================================================================
[32m2026-02-26 12:12:27 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - üóëÔ∏è  Fichier existant supprim√©: /tmp/mssql_export.csv
2026-02-26 12:12:27,911 - INFO - üîß BCPExporter initialis√©:
2026-02-26 12:12:27,911 - INFO -    Mode: Natif
2026-02-26 12:12:27,911 - INFO -    BCP: bcp
[32m2026-02-26 12:12:27 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - üîÑ Ex√©cution BCP...
2026-02-26 12:12:27,938 - INFO - üíª Mode natif
2026-02-26 12:12:27,938 - INFO - üîÑ Commande BCP: bcp SELECT TOP 10000000 * FROM V_Inventory_Parts_Ops WITH (NOLOCK) queryout /tmp/mssql_export.csv -c -C 65001 -t | -r 
 -S *** -d *** -U *** -P ***
2026-02-26 12:14:12,550 - INFO - ‚úÖ Export BCP r√©ussi: Dur√©e 104.61s, Taille 32.31 MB
[32m2026-02-26 12:14:12 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - ‚úÖ Export BCP termin√© en 104.61s
[32m2026-02-26 12:14:12 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops -    Temps BCP: 104.61s
[32m2026-02-26 12:14:12 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops -    Fichier: /tmp/mssql_export.csv
[32m2026-02-26 12:14:12 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops -    Taille: 32.31 MB
[32m2026-02-26 12:14:12 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - ================================================================================
[32m2026-02-26 12:14:12 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - üîß Setup Snowflake
[32m2026-02-26 12:14:12 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - ================================================================================
2026-02-26 12:14:12,664 - INFO - Snowflake Connector for Python Version: 4.3.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-02-26 12:14:12,665 - INFO - Connecting to GLOBAL Snowflake domain
[32m2026-02-26 12:14:15 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - üîß Cr√©ation du file format CSV...
[32m2026-02-26 12:14:16 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - ‚úÖ File format mssql_csv_file_format cr√©√©
[32m2026-02-26 12:14:16 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - üîß Cr√©ation du stage...
[32m2026-02-26 12:14:16 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - ‚úÖ Stage MSSQL_DIRECT_STAGE cr√©√©
[32m2026-02-26 12:14:16 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - üîß Cr√©ation de la table NEEMBA.EQUIPEMENT.V_Inventory_Parts_Ops...
2026-02-26 12:14:16,423 - INFO - üîß G√©n√©ration DDL: AI_V_INVENTORY_PARTS_OPS
2026-02-26 12:14:16,424 - INFO - üìã Extraction du sch√©ma: V_Inventory_Parts_Ops
2026-02-26 12:14:18,317 - INFO - ‚úÖ 20 colonnes extraites
2026-02-26 12:14:18,394 - INFO - ‚úÖ DDL g√©n√©r√© (20 colonnes)
 CREATE OR REPLACE TABLE NEEMBA.EQUIPEMENT.AI_V_INVENTORY_PARTS_OPS (
    Sequentiel_fifo NUMBER(10,0),
    Code_Societe VARCHAR(10) NULL,
    Libelle_Societe VARCHAR(50) NULL,
    Code_Agence VARCHAR(10),
    Libelle_Agence VARCHAR(50),
    Code_Constructeur VARCHAR(10) NULL,
    Libelle_Constructeur VARCHAR(50) NULL,
    Code_Produit VARCHAR(35),
    Libelle_Produit VARCHAR(200),
    Date_Entree_Stock TIMESTAMP_NTZ,
    Valeur_Stock_Total_EUR NUMBER(38,4),
    Quantite_Allouee NUMBER(10,0),
    Quantite_Non_Allouee NUMBER(10,0),
    PMP_EUR NUMBER(25,2),
    Type_Stock VARCHAR(10) NULL,
    Libelle_Type_Stock VARCHAR(50) NULL,
    Return_Code NUMBER(10,0),
    Age_Stock NUMBER(38,6),
    Qte_En_Stock NUMBER(10,2),
    NB_Demands_12m NUMBER(10,0)
)
[32m2026-02-26 12:14:18 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - ‚úÖ Table V_Inventory_Parts_Ops cr√©√©e avec succ√®s
[32m2026-02-26 12:14:18 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops -    Localisation: NEEMBA.EQUIPEMENT.V_Inventory_Parts_Ops
[32m2026-02-26 12:14:19 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - ================================================================================
[32m2026-02-26 12:14:19 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - üì§ Upload vers Snowflake Stage
[32m2026-02-26 12:14:19 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - ================================================================================
2026-02-26 12:14:19,108 - INFO - Snowflake Connector for Python Version: 4.3.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-02-26 12:14:19,108 - INFO - Connecting to GLOBAL Snowflake domain
[32m2026-02-26 12:14:21 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - üîÑ Upload de mssql_export.csv...
[32m2026-02-26 12:14:25 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - ‚úÖ Upload termin√© en 3.76s
[32m2026-02-26 12:14:25 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - üìÅ Fichiers dans le stage: 1
[32m2026-02-26 12:14:25 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - ================================================================================
[32m2026-02-26 12:14:25 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - üì• COPY INTO Snowflake
[32m2026-02-26 12:14:25 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - ================================================================================
2026-02-26 12:14:25,936 - INFO - Snowflake Connector for Python Version: 4.3.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-02-26 12:14:25,937 - INFO - Connecting to GLOBAL Snowflake domain
[32m2026-02-26 12:14:28 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - üîÑ Chargement dans AI_V_INVENTORY_PARTS_OPS...
[32m2026-02-26 12:14:32 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops -    ‚úì mssql_direct_stage/mssql_export.csv.gz: 210,628 lignes
[32m2026-02-26 12:14:32 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - ‚úÖ COPY INTO termin√© en 3.68s
[32m2026-02-26 12:14:32 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - üìä‚úÖ Nombre de lignes charg√©es : 210,628
[32m2026-02-26 12:14:32 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - üìä‚ùå Nombre d'erreurs : 1
[32m2026-02-26 12:14:32 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - üìä Total dans la table AI_V_INVENTORY_PARTS_OPS: 210,627
[32m2026-02-26 12:14:32 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - 
================================================================================
[32m2026-02-26 12:14:32 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - ‚úÖ PIPELINE TERMIN√â AVEC SUCC√àS
[32m2026-02-26 12:14:32 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - üïí Temps total Snowflake: 125.05s
[32m2026-02-26 12:14:32 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - üìä Total lignes ins√©r√©es: 210,628
[32m2026-02-26 12:14:32 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - ‚ö° D√©bit: 1684 rows/sec
[32m2026-02-26 12:14:32 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - v_Inventory_Parts_Ops - ================================================================================

[32m2026-02-26 12:14:32 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - 2526138 - v_Inventory_Parts_Ops - STEP_OUTPUT - Yielded output "result" of type "Any". (Type check passed).
2026-02-26 12:14:32,878 - INFO - Context impl SQLiteImpl.
2026-02-26 12:14:32,878 - INFO - Will assume non-transactional DDL.
[32m2026-02-26 12:14:32 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - 2526138 - v_Inventory_Parts_Ops - ASSET_MATERIALIZATION - Materialized value v_Inventory_Parts_Ops.
[32m2026-02-26 12:14:32 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 54e2c1b3-7b02-4fb7-8e8e-630aad424414 - 2526138 - v_Inventory_Parts_Ops - STEP_SUCCESS - Finished execution of step "v_Inventory_Parts_Ops" in 2m5s.
