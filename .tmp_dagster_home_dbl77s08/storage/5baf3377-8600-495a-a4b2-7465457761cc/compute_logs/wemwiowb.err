[32m2026-02-26 12:12:13 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - 2525433 - LOGS_CAPTURED - Started capturing logs in process (pid: 2525433).
[32m2026-02-26 12:12:13 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - 2525433 - V_facture_dashboard_am - STEP_START - Started execution of step "V_facture_dashboard_am".
[32m2026-02-26 12:12:13 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - 
================================================================================
[32m2026-02-26 12:12:13 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - üöÄ PIPELINE MSSQL ‚Üí SNOWFLAKE
[32m2026-02-26 12:12:13 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - üì§‚û°Ô∏è‚ùÑÔ∏è  M√©thode: BCP + COPY INTO
[32m2026-02-26 12:12:13 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - ================================================================================

[32m2026-02-26 12:12:13 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - ================================================================================
[32m2026-02-26 12:12:13 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - üì§ Export BCP depuis SQL Server pour la table V_facture_dashboard_am
[32m2026-02-26 12:12:13 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - ================================================================================
[32m2026-02-26 12:12:13 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - üóëÔ∏è  Fichier existant supprim√©: /tmp/mssql_export.csv
2026-02-26 12:12:13,834 - INFO - üîß BCPExporter initialis√©:
2026-02-26 12:12:13,835 - INFO -    Mode: Natif
2026-02-26 12:12:13,835 - INFO -    BCP: bcp
[32m2026-02-26 12:12:13 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - üîÑ Ex√©cution BCP...
2026-02-26 12:12:13,857 - INFO - üíª Mode natif
2026-02-26 12:12:13,857 - INFO - üîÑ Commande BCP: bcp SELECT TOP 10000000 * FROM V_facture_dashboard_am WITH (NOLOCK) queryout /tmp/mssql_export.csv -c -C 65001 -t | -r 
 -S *** -d *** -U *** -P ***
2026-02-26 12:34:03,604 - INFO - ‚úÖ Export BCP r√©ussi: Dur√©e 1309.73s, Taille 32.31 MB
[32m2026-02-26 12:34:04 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - ‚úÖ Export BCP termin√© en 1309.80s
[32m2026-02-26 12:34:04 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am -    Temps BCP: 1309.73s
[32m2026-02-26 12:34:04 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am -    Fichier: /tmp/mssql_export.csv
[32m2026-02-26 12:34:04 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am -    Taille: 32.31 MB
[32m2026-02-26 12:34:04 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - ================================================================================
[32m2026-02-26 12:34:04 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - üîß Setup Snowflake
[32m2026-02-26 12:34:04 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - ================================================================================
2026-02-26 12:34:04,291 - INFO - Snowflake Connector for Python Version: 4.3.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-02-26 12:34:04,370 - INFO - Connecting to GLOBAL Snowflake domain
[32m2026-02-26 12:34:10 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - üîß Cr√©ation du file format CSV...
[32m2026-02-26 12:34:10 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - ‚úÖ File format mssql_csv_file_format cr√©√©
[32m2026-02-26 12:34:10 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - üîß Cr√©ation du stage...
[32m2026-02-26 12:34:10 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - ‚úÖ Stage MSSQL_DIRECT_STAGE cr√©√©
[32m2026-02-26 12:34:10 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - üîß Cr√©ation de la table NEEMBA.EQUIPEMENT.V_facture_dashboard_am...
2026-02-26 12:34:10,789 - INFO - üîß G√©n√©ration DDL: AI_V_facture_dashboard_am
2026-02-26 12:34:10,789 - INFO - üìã Extraction du sch√©ma: V_facture_dashboard_am
2026-02-26 12:34:15,614 - INFO - ‚úÖ 49 colonnes extraites
2026-02-26 12:34:15,757 - INFO - ‚úÖ DDL g√©n√©r√© (49 colonnes)
 CREATE OR REPLACE TABLE NEEMBA.EQUIPEMENT.AI_V_facture_dashboard_am (
    tier_sk NUMBER(10,0),
    id_commande_facture NUMBER(10,0),
    libelle_application VARCHAR(50),
    Canal_application VARCHAR(8) NULL,
    tie_facture_sk NUMBER(10,0),
    code_dra VARCHAR(10) NULL,
    id_dwh_fact_rem_unique VARCHAR(70),
    id_jade_fact_rem_unique VARCHAR(60),
    id_rem_ttc VARCHAR(60),
    dra_sk NUMBER(10,0) NULL,
    idjade VARCHAR(50),
    Raison_Sociale VARCHAR(1200),
    code_CIC VARCHAR(80),
    code_dbu VARCHAR(80),
    code_agence VARCHAR(30),
    libelle_agence VARCHAR(50),
    code_service VARCHAR(30),
    libelle_service_fr VARCHAR(50),
    gfa_doc_num VARCHAR(30),
    date_facture TIMESTAMP_NTZ,
    annee_mois NUMBER(10,0),
    code_produit VARCHAR(35),
    description_produit VARCHAR(200),
    code_classe VARCHAR(10),
    CCL_Code_Classe2 VARCHAR(10),
    CCL_Code_ClassePPC VARCHAR(10),
    gfd_prix_unitaire_achat_euro NUMBER(23,6),
    gfd_prix_unitaire_vente_euros NUMBER(23,6),
    gfd_quantite NUMBER(38,2),
    gfd_montant_achat_euros NUMBER(38,6),
    gfd_montant_vente_euros NUMBER(38,6),
    gfd_montant_vente_devise_locale NUMBER(38,6),
    gfd_devise_locale VARCHAR(10),
    gcc_numero_dossier VARCHAR(30),
    gde_numero_dossier VARCHAR(30),
    numero_serie_equipmt VARCHAR(25),
    modele VARCHAR(100),
    code_contructeur VARCHAR(10),
    libelle_constructeur VARCHAR(50),
    libelle_tarif VARCHAR(50),
    gtv_libelle VARCHAR(50),
    lib_court_dossier_fr VARCHAR(30),
    code_tarif VARCHAR(10),
    gfa_dos_code VARCHAR(15),
    ppc_type VARCHAR(10),
    minor_type VARCHAR(10),
    major_type VARCHAR(10),
    Pays_destination VARCHAR(50) NULL,
    ptyp_libelle_fr VARCHAR(50)
)
[32m2026-02-26 12:34:16 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - ‚úÖ Table V_facture_dashboard_am cr√©√©e avec succ√®s
[32m2026-02-26 12:34:16 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am -    Localisation: NEEMBA.EQUIPEMENT.V_facture_dashboard_am
[32m2026-02-26 12:34:16 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - ================================================================================
[32m2026-02-26 12:34:16 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - üì§ Upload vers Snowflake Stage
[32m2026-02-26 12:34:16 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - ================================================================================
2026-02-26 12:34:16,737 - INFO - Snowflake Connector for Python Version: 4.3.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-02-26 12:34:16,738 - INFO - Connecting to GLOBAL Snowflake domain
[32m2026-02-26 12:34:19 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - üîÑ Upload de mssql_export.csv...
[32m2026-02-26 12:34:24 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - ‚úÖ Upload termin√© en 4.80s
[32m2026-02-26 12:34:24 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - üìÅ Fichiers dans le stage: 1
[32m2026-02-26 12:34:24 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - ================================================================================
[32m2026-02-26 12:34:25 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - üì• COPY INTO Snowflake
[32m2026-02-26 12:34:25 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - ================================================================================
2026-02-26 12:34:25,038 - INFO - Snowflake Connector for Python Version: 4.3.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-02-26 12:34:25,038 - INFO - Connecting to GLOBAL Snowflake domain
[32m2026-02-26 12:34:27 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - üîÑ Chargement dans AI_V_facture_dashboard_am...
[32m2026-02-26 12:34:38 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am -    ‚úì mssql_direct_stage/mssql_export.csv.gz: 210,628 lignes
[32m2026-02-26 12:34:38 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - ‚úÖ COPY INTO termin√© en 10.74s
[32m2026-02-26 12:34:38 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - üìä‚úÖ Nombre de lignes charg√©es : 210,628
[32m2026-02-26 12:34:38 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - üìä‚ùå Nombre d'erreurs : 210,628
[32m2026-02-26 12:34:39 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - üìä Total dans la table AI_V_facture_dashboard_am: 0
[32m2026-02-26 12:34:39 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - 
================================================================================
[32m2026-02-26 12:34:39 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - ‚úÖ PIPELINE TERMIN√â AVEC SUCC√àS
[32m2026-02-26 12:34:39 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - üïí Temps total Snowflake: 1345.77s
[32m2026-02-26 12:34:39 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - üìä Total lignes ins√©r√©es: 210,628
[32m2026-02-26 12:34:39 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - ‚ö° D√©bit: 157 rows/sec
[32m2026-02-26 12:34:39 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - V_facture_dashboard_am - ================================================================================

[32m2026-02-26 12:34:39 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - 2525433 - V_facture_dashboard_am - STEP_OUTPUT - Yielded output "result" of type "Any". (Type check passed).
2026-02-26 12:34:39,722 - INFO - Context impl SQLiteImpl.
2026-02-26 12:34:39,723 - INFO - Will assume non-transactional DDL.
[32m2026-02-26 12:34:39 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - 2525433 - V_facture_dashboard_am - ASSET_MATERIALIZATION - Materialized value V_facture_dashboard_am.
[32m2026-02-26 12:34:39 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 5baf3377-8600-495a-a4b2-7465457761cc - 2525433 - V_facture_dashboard_am - STEP_SUCCESS - Finished execution of step "V_facture_dashboard_am" in 22m26s.
